#!/bin/bash

if [ "$#" == "0" ] ; then
echo "
    Usage: icm_bootstrap <any argument>

    Parser and scanner files generated by bison and flex must already
    be available (which is true for the standard distribution)

    Before calling this script icm_prepare must have been called.
"                                     
    exit 0
fi

if [ ! -e tmp/INSTALL.sh ] ; then
    echo tmp/INSTALL.sh does not exist. Try running the icm_prepare script
    exit 1
fi

. bootstrap/functions
. tmp/INSTALL.sh


for target in rss icmake icmun icm-pp icm-comp icm-exec
do
    cd $target
    ./icm_bootstrap
    cd ..
done


echo ./scripts to ./tmp
cp scripts/icmbuild.in scripts/icmstart.in tmp/

echo skeleton files to tmp/${SKELDIR}
try cp -r usr/share/icmake/* tmp/${SKELDIR}

echo configuration files to tmp/${CONFDIR}
try cp -r etc/icmake/* tmp/${CONFDIR}

echo man-pages to tmp/${MANDIR}/man1 and .../man7
try cp doc/*.1 tmp/${MANDIR}/man1
try cp doc/*.7 tmp/${MANDIR}/man7

echo ./etc files to tmp/etc/
try cp -r etc  tmp/

echo documentation to tmp/${DOCDIR} and tmp/${DOCDOCDIR}

try mkdir -p tmp/${DOCDIR}/
try cp changelog tmp/${DOCDIR}/

try cp -r examples doc/icmake.doc doc/icmake.ps \
                                doc/README.icmbuild tmp/${DOCDOCDIR}

echo Done.
